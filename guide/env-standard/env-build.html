<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vue项目分环境打包 | Umeet-blog</title>
    <meta name="generator" content="VuePress 1.5.0">
    
    <meta name="description" content="集合脚手架, Vue开发模版, 代码规范, 工作流规范, 前端相关组件, 接口管理平台系统等, 旨在统一前端开发流程, 开发规范, 减少前端重复造轮子, 提升前端开发效率和代码质量">
    <link rel="preload" href="/blog/assets/css/0.styles.a2346270.css" as="style"><link rel="preload" href="/blog/assets/js/app.5182ab50.js" as="script"><link rel="preload" href="/blog/assets/js/2.536c8a71.js" as="script"><link rel="preload" href="/blog/assets/js/31.f2e99ed0.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.6fb3d28c.js"><link rel="prefetch" href="/blog/assets/js/11.89b2dc3f.js"><link rel="prefetch" href="/blog/assets/js/12.96e4923c.js"><link rel="prefetch" href="/blog/assets/js/13.ced5678e.js"><link rel="prefetch" href="/blog/assets/js/14.d196a903.js"><link rel="prefetch" href="/blog/assets/js/15.512de49a.js"><link rel="prefetch" href="/blog/assets/js/16.486c2abf.js"><link rel="prefetch" href="/blog/assets/js/17.8e52bc2f.js"><link rel="prefetch" href="/blog/assets/js/18.13d2063b.js"><link rel="prefetch" href="/blog/assets/js/19.a6cdec2b.js"><link rel="prefetch" href="/blog/assets/js/20.baceb11c.js"><link rel="prefetch" href="/blog/assets/js/21.984ce6d2.js"><link rel="prefetch" href="/blog/assets/js/22.72d18b00.js"><link rel="prefetch" href="/blog/assets/js/23.e3691374.js"><link rel="prefetch" href="/blog/assets/js/24.5a380d33.js"><link rel="prefetch" href="/blog/assets/js/25.3b592447.js"><link rel="prefetch" href="/blog/assets/js/26.3743f161.js"><link rel="prefetch" href="/blog/assets/js/27.404266e7.js"><link rel="prefetch" href="/blog/assets/js/28.35d24cbb.js"><link rel="prefetch" href="/blog/assets/js/29.765250b5.js"><link rel="prefetch" href="/blog/assets/js/3.1f753e14.js"><link rel="prefetch" href="/blog/assets/js/30.b6c013f1.js"><link rel="prefetch" href="/blog/assets/js/32.bf6ef716.js"><link rel="prefetch" href="/blog/assets/js/33.9106324a.js"><link rel="prefetch" href="/blog/assets/js/34.893471f3.js"><link rel="prefetch" href="/blog/assets/js/35.5dc1d9f0.js"><link rel="prefetch" href="/blog/assets/js/4.9a922373.js"><link rel="prefetch" href="/blog/assets/js/5.b1c50692.js"><link rel="prefetch" href="/blog/assets/js/6.853d703c.js"><link rel="prefetch" href="/blog/assets/js/7.c44f6647.js"><link rel="prefetch" href="/blog/assets/js/8.7173a21a.js"><link rel="prefetch" href="/blog/assets/js/9.38a2e444.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.a2346270.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">Umeet-blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/guide/" class="nav-link router-link-active">
  指南
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="功能" class="dropdown-title"><span class="title">功能</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/components/richtext.html" class="nav-link">
  富文本
</a></li><li class="dropdown-item"><!----> <a href="/blog/components/clipboard.html" class="nav-link">
  复制粘贴
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="相关系统" class="dropdown-title"><span class="title">相关系统</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/ecology/scaffold.html" class="nav-link">
  脚手架工具
</a></li><li class="dropdown-item"><!----> <a href="/blog/ecology/onpm.html" class="nav-link">
  NPM镜像仓库
</a></li><li class="dropdown-item"><!----> <a href="/blog/ecology/yapi.html" class="nav-link">
  接口管理平台
</a></li><li class="dropdown-item"><!----> <a href="/blog/ecology/sentry.html" class="nav-link">
  前端错误统计平台
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/guide/" class="nav-link router-link-active">
  指南
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="功能" class="dropdown-title"><span class="title">功能</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/components/richtext.html" class="nav-link">
  富文本
</a></li><li class="dropdown-item"><!----> <a href="/blog/components/clipboard.html" class="nav-link">
  复制粘贴
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="相关系统" class="dropdown-title"><span class="title">相关系统</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/ecology/scaffold.html" class="nav-link">
  脚手架工具
</a></li><li class="dropdown-item"><!----> <a href="/blog/ecology/onpm.html" class="nav-link">
  NPM镜像仓库
</a></li><li class="dropdown-item"><!----> <a href="/blog/ecology/yapi.html" class="nav-link">
  接口管理平台
</a></li><li class="dropdown-item"><!----> <a href="/blog/ecology/sentry.html" class="nav-link">
  前端错误统计平台
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>开发指南</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/guide/common.html" class="sidebar-link">基础</a></li><li><a href="/blog/guide/pc.html" class="sidebar-link">PC端开发</a></li><li><a href="/blog/guide/mobile.html" class="sidebar-link">移动端开发</a></li><li><a href="/blog/guide/library.html" class="sidebar-link">插件开发</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>多环境配置</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/guide/env-standard/env-build.html" class="active sidebar-link">Vue多环境配置</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/guide/env-standard/env-build.html#基于vue-cli2-x创建的项目" class="sidebar-link">基于Vue-cli2.x创建的项目</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/guide/env-standard/env-build.html#安装cross-env" class="sidebar-link">安装cross-env</a></li><li class="sidebar-sub-header"><a href="/blog/guide/env-standard/env-build.html#修改各环境下的参数" class="sidebar-link">修改各环境下的参数</a></li><li class="sidebar-sub-header"><a href="/blog/guide/env-standard/env-build.html#修改项目中的package-json文件" class="sidebar-link">修改项目中的package.json文件</a></li><li class="sidebar-sub-header"><a href="/blog/guide/env-standard/env-build.html#在webpack-prod-conf-js中使用构建环境参数" class="sidebar-link">在webpack.prod.conf.js中使用构建环境参数</a></li><li class="sidebar-sub-header"><a href="/blog/guide/env-standard/env-build.html#调整build-build-js" class="sidebar-link">调整build/build.js</a></li><li class="sidebar-sub-header"><a href="/blog/guide/env-standard/env-build.html#在代码中使用" class="sidebar-link">在代码中使用</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/guide/env-standard/env-build.html#基于vue-cli3-x创建的项目" class="sidebar-link">基于Vue-cli3.x创建的项目</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/guide/env-standard/env-build.html#package-json增加环境打包命令" class="sidebar-link">package.json增加环境打包命令</a></li><li class="sidebar-sub-header"><a href="/blog/guide/env-standard/env-build.html#在项目根目录下增加环境配置文件-env-test-和-env-production" class="sidebar-link">在项目根目录下增加环境配置文件.env.test 和 .env.production</a></li><li class="sidebar-sub-header"><a href="/blog/guide/env-standard/env-build.html#区分环境，在vue-config-js中增加配置" class="sidebar-link">区分环境，在vue.config.js中增加配置</a></li></ul></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>代码规范</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/guide/code-standard/html.html" class="sidebar-link">HTML编码规范</a></li><li><a href="/blog/guide/code-standard/css.html" class="sidebar-link">CSS编码规范</a></li><li><a href="/blog/guide/code-standard/js.html" class="sidebar-link">JS编码规范</a></li><li><a href="/blog/guide/code-standard/vue.html" class="sidebar-link">Vue编码规范</a></li><li><a href="/blog/guide/code-standard/eslint.html" class="sidebar-link">ESLint规范</a></li><li><a href="/blog/guide/code-standard/filename.html" class="sidebar-link">命名规范</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>工作流规范</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/guide/dev-standard/project-version.html" class="sidebar-link">版本规范</a></li><li><a href="/blog/guide/dev-standard/git-version.html" class="sidebar-link">Git-Flow工作流规范</a></li><li><a href="/blog/guide/cooperation-standard/cooperation.html" class="sidebar-link">前后端协作流程规范</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="vue项目分环境打包"><a href="#vue项目分环境打包" class="header-anchor">#</a> Vue项目分环境打包</h1> <blockquote><p>在项目开发中，我们的项目一般分为开发版、测试版、Pre版、Prod版。Vue-cli的默认环境一只有dev和prod两个，之前每次要发布测试版或Pre版都是修改了源码中API地址后打包，这样很麻烦。如果能根据不同环境打包就完美了</p></blockquote> <h2 id="基于vue-cli2-x创建的项目"><a href="#基于vue-cli2-x创建的项目" class="header-anchor">#</a> 基于Vue-cli2.x创建的项目</h2> <h3 id="安装cross-env"><a href="#安装cross-env" class="header-anchor">#</a> 安装cross-env</h3> <p>在项目目录下根据如下命令安装cross-env</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">npm</span> i --save-dev cross-env
</code></pre></div><h3 id="修改各环境下的参数"><a href="#修改各环境下的参数" class="header-anchor">#</a> 修改各环境下的参数</h3> <p>在<code>config/</code>目录下增加<code>test.env.js</code>、 <code>pre.env.js</code>、 <code>prod.env.js</code>.</p> <p>修改<code>prod.env.js</code>里的内容，修改后的内容大致如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">'use strict'</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">NODE_ENV</span><span class="token operator">:</span> <span class="token string">'&quot;production&quot;'</span><span class="token punctuation">,</span>
  <span class="token constant">EVN_CONFIG</span><span class="token operator">:</span><span class="token string">'&quot;prod&quot;'</span><span class="token punctuation">,</span>
  <span class="token constant">API_ROOT</span><span class="token operator">:</span><span class="token string">'&quot;/apis/v1&quot;'</span>
<span class="token punctuation">}</span>
</code></pre></div><p>修改<code>test.env.js</code>和<code>pre.env.js</code>文件中的内容，如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">'use strict'</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">NODE_ENV</span><span class="token operator">:</span> <span class="token string">'&quot;testing&quot;'</span><span class="token punctuation">,</span>
  <span class="token constant">EVN_CONFIG</span><span class="token operator">:</span><span class="token string">'&quot;test&quot;'</span><span class="token punctuation">,</span>
  <span class="token constant">API_ROOT</span><span class="token operator">:</span><span class="token string">'&quot;/test/apis/train&quot;'</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token string">'use strict'</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">NODE_ENV</span><span class="token operator">:</span> <span class="token string">'&quot;presentation&quot;'</span><span class="token punctuation">,</span>
  <span class="token constant">EVN_CONFIG</span><span class="token operator">:</span><span class="token string">'&quot;pre&quot;'</span><span class="token punctuation">,</span>
  <span class="token constant">API_ROOT</span><span class="token operator">:</span><span class="token string">'&quot;/pre/apis/train&quot;'</span>
<span class="token punctuation">}</span>
</code></pre></div><p>对<code>dev.env.js</code>文件内容进行内容，修改后的内容如下：</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">merge</span><span class="token punctuation">(</span>prodEnv<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token constant">NODE_ENV</span><span class="token operator">:</span> <span class="token string">'&quot;development&quot;'</span><span class="token punctuation">,</span>
  <span class="token constant">EVN_CONFIG</span><span class="token operator">:</span> <span class="token string">'&quot;dev&quot;'</span><span class="token punctuation">,</span>
  <span class="token constant">API_ROOT</span><span class="token operator">:</span> <span class="token string">'&quot;api/apis/v1&quot;'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="修改项目中的package-json文件"><a href="#修改项目中的package-json文件" class="header-anchor">#</a> 修改项目中的package.json文件</h3> <p>对package.json文件中的scripts内容进行修改，添加自定义的几种环境的打包过程，命令中的参数配置要与config中定义的环境变量一致</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token string">&quot;dev&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack-dev-server --inline --progress --config build/webpack.dev.conf.js&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;start&quot;</span><span class="token operator">:</span> <span class="token string">&quot;npm run dev&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;node build/build.js&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;build:test&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cross-env NODE_ENV=production env_config=test node build/build.js&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;build:pre&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cross-env NODE_ENV=production env_config=pre node build/build.js&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;build:prod&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cross-env NODE_ENV=production env_config=prod node build/build.js&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>在这里，NODE_ENV最好都设成production，因为在utils.js只做了production一种判定</p></div> <p>修改<code>config/index.js</code>文件中<code>build</code>参数, 这里的参数会在<code>build/webpack.prod.conf.js</code>中使用到</p> <div class="language-js extra-class"><pre class="language-js"><code>build<span class="token operator">:</span><span class="token punctuation">{</span>
  <span class="token comment">// Template for index.html</span>
  <span class="token comment">// 添加test pre prod 三处环境的配制</span>
  prodEnv<span class="token operator">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./prod.env'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  preEnv<span class="token operator">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./pre.env'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  testEnv<span class="token operator">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./test.env'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  
  <span class="token comment">//下面为原本的内容，不需要做任何个性</span>
  index<span class="token operator">:</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">'../dist/index.html'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</code></pre></div><h3 id="在webpack-prod-conf-js中使用构建环境参数"><a href="#在webpack-prod-conf-js中使用构建环境参数" class="header-anchor">#</a> 在webpack.prod.conf.js中使用构建环境参数</h3> <p>对<code>build/webpack.prod.conf.js</code>文件进行修改，调整<code>env</code>常量的生成方式</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 个性env常量的定义</span>
<span class="token comment">// const env = require('../config/prod.env')</span>
<span class="token keyword">const</span> env <span class="token operator">=</span> config<span class="token punctuation">.</span>build<span class="token punctuation">[</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>env_config <span class="token operator">+</span> <span class="token string">'Env'</span><span class="token punctuation">]</span>
</code></pre></div><h3 id="调整build-build-js"><a href="#调整build-build-js" class="header-anchor">#</a> 调整build/build.js</h3> <p>删除<code>process.env.NODE_ENV</code>的赋值, 修改<code>spinner</code>的定义, 调整后的内容如下</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">'use strict'</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./check-versions'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 注释掉的代码</span>
<span class="token comment">// process.env.NODE_ENV = 'production'</span>

<span class="token keyword">const</span> ora <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'ora'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> rm <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'rimraf'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> chalk <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'chalk'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../config'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> webpackConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./webpack.prod.conf'</span><span class="token punctuation">)</span>

<span class="token comment">// 修改spinner的定义</span>
<span class="token comment">// const spinner = ora('building for production...')</span>
<span class="token keyword">var</span> spinner <span class="token operator">=</span> <span class="token function">ora</span><span class="token punctuation">(</span><span class="token string">'building for '</span> <span class="token operator">+</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">+</span> <span class="token string">' of '</span> <span class="token operator">+</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>env_config <span class="token operator">+</span> <span class="token string">' mode...'</span> <span class="token punctuation">)</span>
spinner<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">//更多的其它内容，不需要做任何调整的内容 ... </span>
</code></pre></div><h3 id="在代码中使用"><a href="#在代码中使用" class="header-anchor">#</a> 在代码中使用</h3> <p>在代码中使用环境变量代替，如API地址</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//Axios.defaults.baseURL = &quot;/apis/v1&quot;</span>
Axios<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>baseURL <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">API_ROOT</span>
</code></pre></div><h2 id="基于vue-cli3-x创建的项目"><a href="#基于vue-cli3-x创建的项目" class="header-anchor">#</a> 基于Vue-cli3.x创建的项目</h2> <blockquote><p>只需要三个步骤即可实现根据环境不同而自动改变请求域名的需求，不需手动更改. 通过改变<code>process.env.NODE_ENV</code>值区分打包环境，但是webpack打包时针对<code>process.env.NODE_ENV===‘production’</code>和其他情况打出来的包结构和大小都不一样；为了消除这种差异，可以使用其他变量比如<code>process.env.VUE_APP_ENV_CONFIG</code>来区分环境</p></blockquote> <h3 id="package-json增加环境打包命令"><a href="#package-json增加环境打包命令" class="header-anchor">#</a> package.json增加环境打包命令</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;serve&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vue-cli-service serve&quot;</span><span class="token punctuation">,</span> <span class="token comment">//本地运行，会把process.env.NODE_ENV设置为‘development‘</span>
    <span class="token string">&quot;test&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vue-cli-service build --mode test&quot;</span><span class="token punctuation">,</span><span class="token comment">//设置第二部的文件之后运行此命令会把process.env.NODE_ENV设置为‘production‘</span>
    <span class="token string">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vue-cli-service build --mode build&quot;</span><span class="token comment">//设置第二部的文件之后运行此命令会把process.env.NODE_ENV设置为‘production‘</span>
  <span class="token punctuation">}</span>
</code></pre></div><h3 id="在项目根目录下增加环境配置文件-env-test-和-env-production"><a href="#在项目根目录下增加环境配置文件-env-test-和-env-production" class="header-anchor">#</a> 在项目根目录下增加环境配置文件<code>.env.test</code> 和 <code>.env.production</code></h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token constant">NODE_ENV</span><span class="token operator">=</span><span class="token string">'production'</span>
# 区分环境
<span class="token constant">VUE_APP_ENV_CONFIG</span><span class="token operator">=</span><span class="token string">'test'</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token constant">NODE_ENV</span><span class="token operator">=</span><span class="token string">'production'</span>
# 区分环境
<span class="token constant">VUE_APP_ENV_CONFIG</span><span class="token operator">=</span><span class="token string">'production'</span>
</code></pre></div><h3 id="区分环境，在vue-config-js中增加配置"><a href="#区分环境，在vue-config-js中增加配置" class="header-anchor">#</a> 区分环境，在<code>vue.config.js</code>中增加配置</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 区分环境的变量</span>
<span class="token keyword">var</span> env <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">'development'</span> <span class="token operator">?</span> <span class="token string">'development'</span> <span class="token operator">:</span>
    process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VUE_APP_ENV_CONFIG</span>
<span class="token comment">// 根据不同环境配置接口请求地址 </span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>env<span class="token operator">===</span><span class="token string">&quot;development&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  axios<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>baseURL <span class="token operator">=</span> <span class="token string">&quot;本地环境域名&quot;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>env<span class="token operator">===</span><span class="token string">&quot;alpha&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  axios<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>baseURL <span class="token operator">=</span> <span class="token string">&quot;测试环境域名&quot;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>env<span class="token operator">===</span><span class="token string">&quot;production&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  axios<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>baseURL <span class="token operator">=</span> <span class="token string">&quot;上线环境域名&quot;</span>
<span class="token punctuation">}</span> 
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">5/16/2020, 3:57:46 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/guide/library.html" class="prev">
        插件开发
      </a></span> <span class="next"><a href="/blog/guide/code-standard/html.html">
        HTML编码规范
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.5182ab50.js" defer></script><script src="/blog/assets/js/2.536c8a71.js" defer></script><script src="/blog/assets/js/31.f2e99ed0.js" defer></script>
  </body>
</html>
