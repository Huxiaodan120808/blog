(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{391:function(t,s,a){"use strict";a.r(s);var n=a(44),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"pc端开发模板"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pc端开发模板"}},[t._v("#")]),t._v(" PC端开发模板")]),t._v(" "),a("h2",{attrs:{id:"目录结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#目录结构"}},[t._v("#")]),t._v(" 目录结构")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("├── assets                "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 打包图片资源")]),t._v("\n├── build                 "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# zoom-sdk 编译产生的依赖包")]),t._v("\n├── lib                   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# zoom-sdk 依赖包")]),t._v("\n├── mac-tool              "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# mac端打包需要的脚本文件")]),t._v("\n│   └──preinstall         "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 脚本文件--实现重装清缓存、卸载干净旧的包")]),t._v("\n├── node_modules          "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# npm本地依赖包")]),t._v("\n├── OutUmeet              "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 打包输出应用包")]),t._v("\n├── renderViews           "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 渲染进程视图，由vueProject编译输出")]),t._v("\n├── sdk                   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# zoom-sdk 依赖包")]),t._v("\n│   ├── mac               "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# mac平台依赖的sdk")]),t._v("\n│   └── win32             "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# windows平台依赖的sdk")]),t._v("\n├── vueProject            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 渲染进程项目")]),t._v("\n│   ├── node_modules      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# npm本地依赖包")]),t._v("\n│   ├── public            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 该目录下的静态资源会被复制到输出目录（dist）中，不经过 webpack处理")]),t._v("\n│   ├── src               "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 与后端交互使用相关方法，接口定义")]),t._v("\n│   │   ├── api           "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 与后端交互使用相关方法，接口定义")]),t._v("\n│   │   ├── assets        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 放置一些静态资源，例如图片，图标，字体等")]),t._v("\n│   │   ├── components    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 公共组件  ")]),t._v("\n│   │   ├── lang          "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 国际化多语言定义 ")]),t._v("\n│   │   ├── router        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# vue-router相关配置 https://router.vuejs.org/zh/guide/")]),t._v("\n│   │   ├── store         "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# vuex 相关配置 https://vuex.vuejs.org/zh/")]),t._v("\n│   │   ├── styles        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 公共样式定义")]),t._v("\n│   │   ├── theme         "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 主题定义")]),t._v("\n│   │   ├── utils         "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 工具类定义，详细请阅读“工具类”部分介绍")]),t._v("\n│   │   ├── views         "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 所有的路由组件，业务功能开发")]),t._v("\n│   │   ├── App.vue       "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 路由组件的顶层路由")]),t._v("\n│   │   └── main.js       "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# vue入口文件")]),t._v("\n│   ├── tests             "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 测试")]),t._v("\n│   ├── package.json      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 配置 ")]),t._v("\n│   ├── .browserslistrc   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 指定项目的目标浏览器的范围，查看“配置项")]),t._v("\n│   ├── .env              "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 环境变量配置，详细请阅读“环境变量和模式”部分介绍")]),t._v("\n│   ├── .gitignore        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 配置不提交到git仓库的文件")]),t._v("\n│   ├── babel.config.js   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# es6兼容es5")]),t._v("\n│   ├── postcss.config.js "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 配置rem转换，查看“配置项 - postcss.config.js”了解https://www.npmjs.com/package/postcss-px2rem")]),t._v("\n│    └── vue.config.js    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 配置文件，详细请阅读“配置项-vue.config.js”部分")]),t._v("\n├── win-tool              "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 目录下是windows端打包需要的vc_redist.x86.exe,安装客户端时需要敬慕安装，静默安装的流程在umeet-inno-setup.iss文件里面，直接编译该文件即可。")]),t._v("\n├── .gitignore            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 配置不提交到git仓库的文件")]),t._v("\n├── AppWindow.js          "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 通用窗口")]),t._v("\n├── binding.gyp           "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# zoom-sdk 配置文件")]),t._v("\n├── build_nodeaddon_mac.sh "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# zoom-sdk mac端build脚本")]),t._v("\n├── build_nodeaddon_win_ia32.bat "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# zoom-sdk windows端build脚本")]),t._v("\n├── config.js             "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 整个项目的全局配置，在main.js主进程中使用")]),t._v("\n├── main.js               "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 整个项目的主进程,有且只能有一个入口")]),t._v("\n├── menuTenplate.js       "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# mac端上下文菜单配置")]),t._v("\n├── package.json          "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 配置")]),t._v("\n├── package_script.sh     "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# mac-针对定制项目的快速切换脚本，较少手动修改文件的漏操作，导致定制项目打包出错")]),t._v("\n├── package_script.bat    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# win-针对定制项目的快速切换脚本，较少手动修改文件的漏操作，导致定制项目打包出错")]),t._v("\n├── SignZoomSDK.sh        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# mac-签名依赖包文件脚本")]),t._v("\n\n")])])]),a("h2",{attrs:{id:"基础模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基础模块"}},[t._v("#")]),t._v(" 基础模块")]),t._v(" "),a("h3",{attrs:{id:"electron"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#electron"}},[t._v("#")]),t._v(" Electron")]),t._v(" "),a("p",[t._v("使用前请确保您有"),a("code",[t._v("Electron")]),t._v("基础, 点此前往"),a("a",{attrs:{href:"http://www.electronjs.org/",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("Electron官网")]),a("OutboundLink")],1),t._v("学习")]),t._v(" "),a("h4",{attrs:{id:"主进程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#主进程"}},[t._v("#")]),t._v(" 主进程")]),t._v(" "),a("p",[t._v("项目中 main.js 是整个Electron项目的主进程。\nElectron 运行 package.json 的 main 脚本的进程被称为主进程。 在主进程中运行的脚本通过创建web页面来展示用户界面。 一个 Electron 应用总是有且只有一个主进程。")]),t._v(" "),a("p",[t._v("由于 Electron 使用了 Chromium 来展示 web 页面，所以 Chromium 的多进程架构也被使用到。 每个 Electron 中的 web 页面运行在它的叫渲染进程的进程中。")]),t._v(" "),a("p",[t._v("在普通的浏览器中，web页面通常在沙盒环境中运行，并且无法访问操作系统的原生资源。 然而 Electron 的用户在 Node.js 的 API 支持下可以在页面中和操作系统进行一些底层交互。")]),t._v(" "),a("h4",{attrs:{id:"渲染进程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#渲染进程"}},[t._v("#")]),t._v(" 渲染进程")]),t._v(" "),a("p",[t._v("项目中vueProject编译输出renderViews是整个Electron项目的渲染进程视图，里面的页面给主进程createBrowserWindow时作为视图资源使用。\n主进程使用 BrowserWindow 实例创建页面。 每个 BrowserWindow 实例都在自己的渲染进程里运行页面。 当一个 BrowserWindow 实例被销毁后，相应的渲染进程也会被终止。")]),t._v(" "),a("p",[t._v("主进程管理所有的web页面和它们对应的渲染进程。 每个渲染进程都是独立的，它只关心它所运行的 web 页面。")]),t._v(" "),a("p",[t._v("在页面中调用与 GUI 相关的原生 API 是不被允许的，因为在 web 页面里操作原生的 GUI 资源是非常危险的，而且容易造成资源泄露。 如果你想在 web 页面里使用 GUI 操作，其对应的渲染进程必须与主进程进行通讯，请求主进程进行相关的 GUI 操作。")]),t._v(" "),a("p",[t._v("题外话：进程间通讯\nElectron为主进程（ main process）和渲染器进程（renderer processes）通信提供了多种实现方式，如可以使用ipcRenderer 和 ipcMain模块发送消息，使用 remote模块进行RPC方式通信。")]),t._v(" "),a("h4",{attrs:{id:"主进程与渲染进程通讯"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#主进程与渲染进程通讯"}},[t._v("#")]),t._v(" 主进程与渲染进程通讯")]),t._v(" "),a("p",[t._v("1、主进程给渲染进程发消息")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// main.js 主进程")]),t._v("\nindexWindow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("webContents"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'language'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" store"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'language'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// App.vue 渲染进程接收消息")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ipcRenderer "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'electron'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ipcRenderer\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 平台语言language")]),t._v("\n  ipcRenderer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'language'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("event"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" value")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    that"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("$changeLang")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("2、渲染进程给主进程发送消息")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// AppHeader.vue 渲染进程接收消息")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ipcRenderer "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'electron'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ipcRenderer\nthat"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("language "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("navigator"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("language"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("includes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'zh'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'zh'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'en'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nipcRenderer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'windows-language'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("language"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" that"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("language"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" isChange"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// main.js 主进程  监听接收")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ASSECPT:接收渲染进程消息--系统语言")]),t._v("\nipcMain"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'windows-language'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("logEverywhere")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'切换语言：'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  locallanguage "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("language"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  store"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'language'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" locallanguage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("isSDKAuth"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 根据浏览器语言，设置默认语言后，初始化sdk")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("initSDK")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h3",{attrs:{id:"zoom-sdk-electron"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#zoom-sdk-electron"}},[t._v("#")]),t._v(" Zoom-sdk-electron")]),t._v(" "),a("h4",{attrs:{id:"集成"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#集成"}},[t._v("#")]),t._v(" 集成")]),t._v(" "),a("p",[t._v("1、下载zoom-sdk-electron,把下面文件复制到electron项目根目录下。")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("├── lib                   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# zoom-sdk 依赖包")]),t._v("\n├── sdk                   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# zoom-sdk 依赖包")]),t._v("\n│   ├── mac               "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# mac平台依赖的sdk")]),t._v("\n│   └── win32             "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# windows平台依赖的sdk")]),t._v("\n├── binding.gyp           "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# zoom-sdk 配置文件")]),t._v("\n├── build_nodeaddon_mac.sh "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# zoom-sdk mac端build脚本")]),t._v("\n├── build_nodeaddon_win_ia32.bat "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# zoom-sdk windows端build脚本")]),t._v("\n")])])]),a("p",[t._v("2、编译集成到Electron项目中")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("// mac\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sh")]),t._v(" build_nodeon_mac.sh "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 执行完后会生成 build文件")]),t._v("\n// windows端\n$ build_nodeaddon_win_ia32.bat  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 执行完后会生成 build文件")]),t._v("\n")])])]),a("p",[t._v("3、api的调用请参考zoom-sdk-electron/demo/main.js集成到Electron项目中")]),t._v(" "),a("h4",{attrs:{id:"国际化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#国际化"}},[t._v("#")]),t._v(" 国际化")]),t._v(" "),a("p",[t._v("main.js中")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("  "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("setDomain")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("domain"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" enable_log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" opts "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      path"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// win require absolute path, mac require ''")]),t._v("\n      domain"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" domain"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      enable_log"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" enable_log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      locale"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" locallanguage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("indexOf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'zh'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v("\n        ZoomAPPLocale"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ZNSDK_APP_Locale_CN "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n        ZoomAPPLocale"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ZNSDK_APP_Locale_Default"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// langid: ZoomSDK_LANGUAGE_ID.LANGUAGE_English")]),t._v("\n      langid"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" locallanguage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("indexOf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'zh'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v("\n        ZoomSDK_LANGUAGE_ID"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("LANGUAGE_Chinese_Simplified "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n        ZoomSDK_LANGUAGE_ID"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("LANGUAGE_English\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])]),a("p",[t._v("如果渲染进程切换语言，sdk需要重新初始化，走setdomain这个api才会起效，因此Electron程序需要重启。")]),t._v(" "),a("h4",{attrs:{id:"自定义logo"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#自定义logo"}},[t._v("#")]),t._v(" 自定义LOGO")]),t._v(" "),a("p",[t._v('1、windows端更换所有的\'ZOOM‘\n目录文件：lib/node_add_on/win/wrap/sdk_wrap.cpp\n添加代码22行（sdkerr上面添加）initParam.strBrandingName=L"Umeet"---\x3e对应名称')]),t._v(" "),a("p",[t._v('2、mac端更换所有的\'ZOOM‘\n找到语言文件sdk/mac/Resources\n-----en.loproj/Localizable.strings\n-----zh.loproj/Localizable.strings\n的所有"="等号右边包含zoom/Umeet字符更换成---\x3e对应名称')]),t._v(" "),a("h4",{attrs:{id:"自定义图标"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#自定义图标"}},[t._v("#")]),t._v(" 自定义图标")]),t._v(" "),a("p",[t._v("windows视频会议中左上角的图标自定义：\n把icon.ico、node_res.rc文件复制到lib/node_add_on目录下。\n录下，node_res.rc的代码修改如下")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// node_res.rc详细内容如下：")]),t._v("\n#include"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"resource.h"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("IDI_SDK_ICONICON")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"icon.ico"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("IDI_SDK_BIG_ICONICON")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"icon.ico"')]),t._v("\n")])])]),a("p",[t._v("mac没有这种配置。")]),t._v(" "),a("h3",{attrs:{id:"vue-project"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vue-project"}},[t._v("#")]),t._v(" Vue-project")]),t._v(" "),a("p",[t._v("开发详情参考："),a("a",{attrs:{href:"/guide/web"}},[t._v("WEB端")])]),t._v(" "),a("h2",{attrs:{id:"功能"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#功能"}},[t._v("#")]),t._v(" 功能")]),t._v(" "),a("h3",{attrs:{id:"缓存机制"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#缓存机制"}},[t._v("#")]),t._v(" 缓存机制")]),t._v(" "),a("p",[t._v("Electron使用electron-store实现数据的缓存。清除缓存使用node.js的 fs 以及shell实现缓存的读取和清除功能")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" app_data "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getPath")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'userData'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 缓存的存放地址")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" fs "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'fs'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// nodejs 模块 文件文本操作等等 io")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ASSECPT:接收渲染进程消息---清缓存")]),t._v("\nipcMain"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'clearCache'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("e")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" cachepath "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" app_data "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/Cache'")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("logEverywhere")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'缓存目录：'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cachepath"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" clearTotal "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" dir "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" fs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("readdir")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cachepath"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("v "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" filePath "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("join")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cachepath"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("v"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" rmnum "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" shell"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("moveItemToTrash")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("filePath"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      clearTotal"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// SEND:通知渲染进程---渲染进程清除缓存结果")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("clearTotal "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      indexWindow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("webContents"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'clearCacheStatus'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'successss'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h3",{attrs:{id:"webview通讯"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#webview通讯"}},[t._v("#")]),t._v(" webview通讯")]),t._v(" "),a("p",[t._v("Browserwindow中使用webview需要先配置允许使用")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" indexWindowConfig "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n    webPreferences"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      nodeIntegration"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 开启使用nodejs的配置")]),t._v("\n      webviewTag"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// electron version >5后默认禁用<webview>标签需手动开启或者使用browserview代替")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("渲染进程中")]),t._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[t._v(" "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("webview")]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("v-show")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("!loading"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("id")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("umeetWebView"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("autosize")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("on"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("class")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("web-view"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("nodeintegration")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("webview")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// init webview 创建webview")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("initWebView")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" that "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" webview "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'umeetWebView'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" webviewParent "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'webview-container'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" srcUrl "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" that"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("webViewSrcUrl")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n       webview"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'dom-ready'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 向webview注入js")]),t._v("\n        webview"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("executeJavaScript")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v(" window.Qbian = require('electron');\n            console.log('--executeJavaScript export Object --\x3e ', window.Qbian);\n          ")]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v("\n       "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n       "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n       "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 接收webview传来的消息")]),t._v("\n      webview"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ipc-message'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("event")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//! 消息属性叫channel，有些奇怪，但就是这样")]),t._v("\n        console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'接收webview的消息'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" event"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("channel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" event"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("switch")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("channel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'joinMeeting'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'startMeeting'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" joinOrStartUrl "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" event"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("require"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n              "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ipcRenderer "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"electron"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ipcRenderer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n              ipcRenderer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'callVideoSdkByUrl'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" joinOrStartUrl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("break")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'openBrowser'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" openUrl "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" event"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" params "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" event"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("require"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n              "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ipcRenderer "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"electron"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ipcRenderer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n              "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("params"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                openUrl "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" openUrl "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("?avatar=")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("params"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("avatar"),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("&nickname=")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("params"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nickname"),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("&openid=")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("params"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("openid"),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v("\n              "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n              ipcRenderer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'openBrowser'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" openUrl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("break")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'exit'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            that"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("goback")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("break")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("webview的url资源项目中引入jsbridge-pc.js")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*\n* 客户端 JSSDK\n* 实现与Electron客户端之间的通讯\n* */")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" JsBridge "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 加入会议")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// @params(joinurl): umeetapp://join?meetingId=&displayName=&password=&meetingNumber=&isVideoOff=&isAudioOff&userId=")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("joinMeeting")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("joinUrl")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Qbian"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ipcRenderer "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Qbian"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ipcRenderer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      ipcRenderer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sendToHost")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'joinMeeting'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" joinUrl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 开始会议")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// @params(starturl):umeetapp://start?meetingId=&displayName=&meetingNumber=&hostId=&hostToken=&isVideoOff=&isAudioOff=&userId=")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("startMeeting")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("startUrl")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Qbian"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ipcRenderer "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Qbian"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ipcRenderer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      ipcRenderer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sendToHost")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'startMeeting'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" startUrl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 退出程序")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("exit")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Qbian"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ipcRenderer "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Qbian"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ipcRenderer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      ipcRenderer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sendToHost")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'exit'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 唤起浏览器")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("openBrowser")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" params")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Qbian"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ipcRenderer "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Qbian"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ipcRenderer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      ipcRenderer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sendToHost")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'openBrowser'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" params"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" JsBridge "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("调用 JSBridge.joinMeeting(prams)")]),t._v(" "),a("h2",{attrs:{id:"发布"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#发布"}},[t._v("#")]),t._v(" 发布")]),t._v(" "),a("h3",{attrs:{id:"windows端"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#windows端"}},[t._v("#")]),t._v(" windows端")]),t._v(" "),a("p",[t._v("1、使用electron-builder编译生成exe应用包")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run build:win "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#输出OutUmeet")]),t._v("\n")])])]),a("p",[t._v("2、使用inno-setup打包成安装程序包，用于客户分发。执行 win-tool/Umeet.iss脚本，点此前往"),a("a",{attrs:{href:"https://jrsoftware.org/isinfo.php",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("inno-setup官网")]),a("OutboundLink")],1),t._v("学习")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" 脚本由 Inno Setup 脚本向导 生成！\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" 有关创建 Inno Setup 脚本文件的详细资料请查阅帮助文档！\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#define MyAppName "Umeet"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#define MyAppSortName "Umeet"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#define MyAppVersion "3.1.0-beta1"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#define MyAppPublisher "SYSTEC TECHNOLOGY CO.,LTD"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#define MyAppURL "http://umeet.systec.com.cn"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#define MyAppExeName "Umeet.exe"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#define SchemeName "umeetapp"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#define AppId "{9B19E29F-2157-4667-AFEF-39BDBA2F163B}"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Setup"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" 注: AppId的值为单独标识该应用程序。\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" 不要为其他安装程序使用相同的AppId值。\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("若要生成新的 GUID，可在菜单中点击 "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"工具|生成 GUID"')]),t._v("。"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("AppId")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("#AppId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("AppName")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("#MyAppName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("AppVersion")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("#MyAppVersion"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("AppVerName")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("#MyAppName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("AppVerName")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("#MyAppName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("#MyAppVersion"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("AppPublisher")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("#MyAppPublisher"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("AppPublisherURL")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("#MyAppURL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("AppSupportURL")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("#MyAppURL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("AppUpdatesURL")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("#MyAppURL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("DefaultDirName")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("autopf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("#MyAppName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("DefaultGroupName")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("#MyAppName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("DisableProgramGroupPage")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("yes\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" 以下行取消注释，以在非管理安装模式下运行（仅为当前用户安装）。\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("PrivilegesRequired")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("lowest\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("OutputDir")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("D:"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("umeet-setup\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("OutputBaseFilename")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Umeet-v"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("#MyAppVersion"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("-setup\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("SetupIconFile")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("D:"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("project"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Umeet"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("umeet-pc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("assets"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("icon.ico\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("Uninstallable")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("yes\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("UninstallDisplayIcon")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("icon.ico\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("Compression")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("lzma\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("SolidCompression")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("yes\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("WizardStyle")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("modern\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Languages"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nName: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"chinesesimp"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" MessagesFile: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"compiler:Default.isl"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Tasks"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nName: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"desktopicon"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Description: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{cm:CreateDesktopIcon}"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" GroupDescription: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{cm:AdditionalIcons}"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Flags:  checkablealone"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nName: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"quicklaunchicon"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Description: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{cm:CreateQuickLaunchIcon}"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" GroupDescription: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{cm:AdditionalIcons}"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Flags: unchecked"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" OnlyBelowVersion: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0,6")]),t._v(".1\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Files"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nSource: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"D:\\project\\Umeet\\umeet-pc\\OutUmeet\\win-ia32-unpacked\\Umeet.exe"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" DestDir: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{app}"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Flags: ignoreversion"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("需要静默安装的vc_redist.x86.exe文件\nSource: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"D:\\project\\Umeet\\umeet-pc\\win-tool'),a("span",{pre:!0,attrs:{class:"token entity",title:"\\v"}},[t._v("\\v")]),t._v('c_redist.x86.exe"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" DestDir: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{app}"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Flags: ignoreversion"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" AfterInstall: CustormInstallVC\nSource: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"D:\\project\\Umeet\\umeet-pc\\OutUmeet\\win-ia32-unpacked\\*"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" DestDir: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{app}"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Flags: ignoreversion recursesubdirs createallsubdirs\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" 注意: 不要在任何共享系统文件上使用“Flags: ignoreversion”\nSource: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"D:\\project\\Umeet\\umeet-pc'),a("span",{pre:!0,attrs:{class:"token entity",title:"\\a"}},[t._v("\\a")]),t._v('ssets\\icon.ico"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" DestDir: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{app}"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Icons"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nName: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{autoprograms}\\{#MyAppName}"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Filename: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{app}\\{#MyAppExeName}"')]),t._v("\nName: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{autodesktop}\\{#MyAppName}"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Filename: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{app}\\{#MyAppExeName}"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Tasks: desktopicon\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("开始菜单中添加卸载入口\nName: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{group}\\{#MyAppName}"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Filename: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{app}\\{#MyAppExeName}"')]),t._v("\nName: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{group}\\{cm:UninstallProgram,{#MyAppName}}"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Filename: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{uninstallexe}"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("IconFilename: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{app}\\icon.ico"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Run"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nFilename: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{app}\\{#MyAppExeName}"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Description: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"{cm:LaunchProgram,{#StringChange(MyAppName, '&', '&&')}}\"")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Flags: nowait postinstall skipifsilent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("Filename: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("vc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("vc_redist.x86.exe"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Flags: skipifdoesntexist runhidden  // 没有更多判断的静默安装方式\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Registry"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n// 添加scheme唤起客户端的注册表信息\nRoot: HKCR"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" SubKey: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{#SchemeName}"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" ValueData: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{#MyAppName}"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" ValueType: string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Flags: CreateValueIfDoesntExist UninsDeleteKey"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nRoot: HKCR"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" SubKey: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{#SchemeName}"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" ValueName: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"URL Protocol"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Flags: CreateValueIfDoesntExist"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" ValueType: string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nRoot: HKCR"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" SubKey: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{#SchemeName}\\DefaultIcon"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" ValueData: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{app}\\{#MyAppExeName}"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Flags: CreateValueIfDoesntExist"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" ValueType: string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("#MyAppExeName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v("--params"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("%1"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v(" 后面的表示唤起客户端并且传递url参数 %1表示任意变量\nRoot: HKCR"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" SubKey: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{#SchemeName}\\shell\\open'),a("span",{pre:!0,attrs:{class:"token entity",title:"\\c"}},[t._v("\\c")]),t._v('ommand"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" ValueData: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{app}\\{#MyAppExeName} "')]),t._v('"--params'),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("%1"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v('"'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Flags: CreateValueIfDoesntExist"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" ValueType: string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n// 向注册表中添加 安装后的路径\nRoot:HKLM"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("Subkey:"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"SOFTWARE\\{#MyAppName}"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("Flags:uninsdeletekeyifempty\nRoot:HKLM"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("Subkey:"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"SOFTWARE\\{#MyAppName}"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("ValueType:string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("ValueName:"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"InstallPath"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("ValueData:"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{app}"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("Flags:uninsdeletekey\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Code"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n//静默安装vc_regedit_x86.exe （electron以及zoom-sdk需要的依赖）\nprocedure CustormInstallVC"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nvar\n ResultCode: Integer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nbegin\n // 判断是否安装了vc_regedit_x86.exe\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" not RegValueExists"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("HKEY_LOCAL_MACHINE, "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'SOFTWARE\\WOW6432Node\\Microsoft\\VisualStudio"),a("span",{pre:!0,attrs:{class:"token entity",title:"\\14"}},[t._v("\\14")]),t._v(".0\\VC\\Runtimes"),a("span",{pre:!0,attrs:{class:"token entity",title:"\\x86"}},[t._v("\\x86")]),t._v("'")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Version'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n      begin\n         // 静默安装\n         //MsgBox"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'没有安装vc'")]),t._v(", mbInformation, MB_OK"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n         Exec"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ExpandConstant"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("CurrentFileName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/verysilent /norestart /q'")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v(", SW_HIDE, ewWaitUntilTerminated, ResultCode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      end"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nend"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n// 判断程序是否运行中\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" IsAppRunning"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("const FileName, strExeName "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(": Boolean"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nvar\n    IsRunning: Integer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n   ErrorCode: Integer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n   strCmdKill: String"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  // 终止软件命令\n   appWnd: HWND"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   //进程ID\nbegin\n    Result :"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("true"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" //安装程序继续\n    IsRunning:"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("FindWindowByWindowName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("FileName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    strCmdKill :"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Format"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/c taskkill /f /t /im %s'")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("strExeName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),t._v(" IsRunning"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<>")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n    begin\n       "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" Msgbox"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{#MyAppName} 正在运行,是否要强制退出程序？'")]),t._v(", mbConfirmation, MB_YESNO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" idNO "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n       begin\n       // 点击 否  --- 安装程序退出\n        Result :"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("false"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        IsRunning :"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      end "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" begin\n        // 点击 是--终止程序\n        ShellExec"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'open'")]),t._v(", ExpandConstant"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{cmd}'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", strCmdKill, "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v(", SW_HIDE, ewNoWait, ErrorCode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n          //给进程发送关闭消息\n        //PostMessage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("appWnd, "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("       // quit\n        Result :"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("true"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" //安装程序继续\n        IsRunning :"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      end"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n     end"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nend"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n// 安装前---先删除旧的包\nconst MySetupMutex "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'My Program {#AppId}'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" InitializeSetup"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(": boolean"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nvar\n  ResultStr: String"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  ResultCode: Integer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nbegin\n    Result :"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" not CheckForMutexes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MySetupMutex"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" Result "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n    begin\n        CreateMutex"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MySetupMutex"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n         Result :"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" IsAppRunning"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{#MyAppName}'")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{#MyAppExeName}'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n         "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" Result "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n         begin\n           // 根据注册表中是否存在卸载信息作为依据，是否已经安装了\n           "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" RegKeyExists"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("HKEY_LOCAL_MACHINE, "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\{#AppId}_is1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n              begin\n              "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" RegQueryStringValue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("HKEY_LOCAL_MACHINE, "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\{#AppId}_is1'")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'UninstallString'")]),t._v(", ResultStr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n                begin\n                  // 安装前先删除旧的包\n                  ResultStr :"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" RemoveQuotes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ResultStr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                  Exec"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ResultStr, "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/verysilent /norestart /q'")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v(", SW_HIDE, ewWaitUntilTerminated, ResultCode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                  RegDeleteKeyIncludingSubkeys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("HKCR, "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{#SchemeName}'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                end"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                result :"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            end"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n              result :"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        end"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n         Exit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  end "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" begin\n    //MsgBox"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'您正在安装程序，不能重复操作...'")]),t._v(",mbError,MB_OK"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    Exit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  end"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nend"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n// 安装时 --- 修改卸载的名称（因为默认是unins000）\nprocedure CurStepChanged"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("CurStep: TSetupStep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nvar\nuninspath, uninsname, NewUninsName: String"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nbegin\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("CurStep")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ssDone "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n    begin\n      // 指定新的卸载文件名（不包含扩展名），请相应修改！\n      NewUninsName:"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'卸载{#MyAppName}'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      // 以下重命名卸载文件\n      uninspath:"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ExtractFilePath"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ExpandConstant"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{uninstallexe}'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("))")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      uninsname:"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Copy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ExtractFileName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ExpandConstant"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{uninstallexe}'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("))")]),t._v(",1,8"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      RenameFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("uninspath + uninsname + "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.exe'")]),t._v(", uninspath + NewUninsName + "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.exe'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      RenameFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("uninspath + uninsname + "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.dat'")]),t._v(", uninspath + NewUninsName + "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.dat'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      // 修改注册表 卸载信息\n      RegWriteStringValue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("HKEY_LOCAL_MACHINE, "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\{#AppId}_is1'")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'UninstallString'")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\"'")]),t._v(" + uninspath + NewUninsName + "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.exe\"'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      RegWriteStringValue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("HKEY_LOCAL_MACHINE, "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\{#AppId}_is1'")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'QuietUninstallString'")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\"'")]),t._v(" + uninspath + NewUninsName + "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.exe\" /silent'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      end"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nend"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n// 卸载时---- 关闭软件\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" InitializeUninstall"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(": Boolean"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nbegin\n  Result :"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" IsAppRunning"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{#MyAppName}'")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{#MyAppExeName}'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nend"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n// 卸载时 ---- 删除注册表信息\nprocedure CurUninstallStepChanged"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("CurUninstallStep: TUninstallStep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nbegin\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" CurUninstallStep "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" usUninstall "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n DelTree"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ExpandConstant"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{app}'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", True, True, True"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n DelTree"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ExpandConstant"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{userappdata}\\{#MyAppName}'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", True, True, True"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("    // 删除缓存文件\n DelTree"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ExpandConstant"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{userappdata}\\{#MyAppSortName}'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", True, True, True"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("    // 删除缓存文件\n RegDeleteKeyIncludingSubkeys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("HKCR, "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{#SchemeName}'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nend"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("执行完后会生成setup.exe安装程序包，客户端可自定义安装目录等。")]),t._v(" "),a("h3",{attrs:{id:"mac端"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mac端"}},[t._v("#")]),t._v(" mac端")]),t._v(" "),a("p",[t._v("1、使用electron-builder 编译生成Umeet.app程序包")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run build:mac "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#输出OutUmeet")]),t._v("\n")])])]),a("p",[t._v("2、使用package工具把Umeet.app打包成pkg安装程序包，并添加脚本文件，实现覆盖安装以及清除缓存功能。\n脚本文件在mac-tool/preinstall")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token shebang important"}},[t._v("#!/usr/bin/env bash")]),t._v("\n \n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Running HEDU.app preinstall script."')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Killing HEDU.app."')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("killall")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"HEDU"')]),t._v("\n \n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Finding old versions of HEDU."')]),t._v("\nmdfind -onlyin /Applications "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"kMDItemCFBundleIdentifier=='cn.com.systec.umeet.hsedugroup'\"")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("xargs")]),t._v(" -I % "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" -rf %\n \n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" -rf  ~/Library/Application"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(" Support/HEDU/\n\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Removed old versions of HEDU.app, if any."')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Ran HEDU.app preinstall script."')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 以下是曾用名，如果当前应用没有曾用名，则不要重复以下代码")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Running AImeet.app preinstall script."')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Killing AImeet.app."')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("killall")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"AImeet"')]),t._v("\n \n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Finding old versions of AImeet."')]),t._v("\nmdfind -onlyin /Applications "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"kMDItemCFBundleIdentifier=='cn.com.systec.umeet.hsedugroup'\"")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("xargs")]),t._v(" -I % "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" -rf %\n \n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" -rf  ~/Library/Application"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(" Support/AImeet/\n\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Removed old versions of AImeet.app, if any."')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Ran AImeet.app preinstall script."')]),t._v("\n \n\n")])])]),a("p",[t._v("会输出 umeet.pkg\n再进行签名等操作后即可分发给客户。")])])}),[],!1,null,null,null);s.default=e.exports}}]);